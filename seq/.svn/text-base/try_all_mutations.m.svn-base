function [syn mis nons] = try_all_mutations(dna)

%% examines all possible point mutations _in silico_
%% and counts how many would be synonymous, missense, and nonsense
%% 
%% assumes "dna" is already the transcribed strand, in +0 frame.
%%
%% for now, mutations that _remove_ a stop codon are called "missense"...
%% may want to change this in a future version.
%%
%% Mike Lawrence 2008/04/17

M = [ 1,7,1;1,8,0;1,7,1;1,8,0;3,6,0;3,6,0;3,6,0;3,6,0;2,6,1;1,8,0;2,7,0;1,8,0;2,7,0;2,7,0;2,7,0;2,7,0;1,7,1;1,8,0;1, ...
      7,1;1,8,0;3,6,0;3,6,0;3,6,0;3,6,0;4,4,1;3,6,0;4,5,0;3,6,0;3,6,0;2,7,0;2,7,0;2,7,0;1,7,1;1,8,0;1,7,1;1,8,0;3,6, ...
      0;3,6,0;3,6,0;3,6,0;3,5,1;3,6,0;3,6,0;3,6,0;3,6,0;3,6,0;3,6,0;3,6,0;2,7,0;1,6,2;1,8,0;1,6,2;3,4,2;3,6,0;3,5,1; ...
      3,6,0;1,8,0;1,7,1;0,7,2;1,7,1;1,6,2;1,8,0;2,6,1;1,8,0 ];

C = [656565;656567;656571;656584;656765;656767;656771;656784;657165;657167;657171;657184;658465;658467;658471;658484; ...
     676565;676567;676571;676584;676765;676767;676771;676784;677165;677167;677171;677184;678465;678467;678471;678484; ...
     716565;716567;716571;716584;716765;716767;716771;716784;717165;717167;717171;717184;718465;718467;718471;718484; ...
     846565;846567;846571;846584;846765;846767;846771;846784;847165;847167;847171;847184;848465;848467;848471;848484 ];

d = double(upper(dna));
d = d(1:3*ceil(length(d)/3));
d = reshape(d,3,length(d)/3);
d = 10000*d(1,:) + 100*d(2,:) + d(3,:);
[du di dj] = unique(d);
n = length(du);
ci = zeros(n,1);
cc = zeros(n,1);
for i=1:n
  ci(i) = find(C==du(i));
  cc(i) = sum(dj==i);
end
m = M(ci,:);
mm = m .* repmat(cc,1,3);
smm = sum(mm,1);
syn = smm(1);
mis = smm(2);
nons = smm(3);




