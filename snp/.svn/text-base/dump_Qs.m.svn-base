function dump_Qs(Qs,pos,outpath,qfields)
% DUMP_QS dump Qs event tables to tab separated tables

if ~exist('qfields','var') || isempty(qfields)
    qfields = {'amp','del','aod','doa'};
end

if outpath(end) ~= '.' || outpath(end) ~= filesep
    outpath = [outpath '/'];
end

qfields = intersect(qfields,fields(Qs));

for k = 1:length(qfields)
    fld = qfields{k};
    write_filtered_tabcols([outpath fld '.tsv'],[], ...
        {'chr',Qs.(fld)(:,1)},...
        {'snp_start',Qs.(fld)(:,2)},...
        {'snp_end',Qs.(fld)(:,3)},...
        {'base_start',pos(Qs.(fld)(:,2))},...
        {'base_end',pos(Qs.(fld)(:,3))},...
        {'sample',Qs.(fld)(:,5)},...
        {'cn_start',Qs.(fld)(:,6)},...
        {'cn_end',Qs.(fld)(:,7)},...
        {'event_length',Qs.(fld)(:,8)},...
        {'arm_level',Qs.(fld)(:,9)},...
        {'amplitude',Qs.(fld)(:,12)} );
    display([num2str(size(Qs.(fld),1)),' ',fld,'s']);
end
        